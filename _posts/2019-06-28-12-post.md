---
title: "안드로이드 6.0 -> 7.0 변경점"
date: 2019-06-28 16:11:18 -0400
categories: Android Framework
---

Android 7.0  변경점
=============
Android 7.0으로 버전이 올라가면서 무엇이 바뀌었나 살펴보고 6.0에 다시 적용시킬것을 찾아보자.


배터리와 메모리
-------------
배터리 수명을 연장하고 RAM 사용량을 감소시키기 위한 시스템 동작 변경사항 포함.

### 잠자기 모드
** Android 6.0
사용자가 기기의 플러그를 뽑고 정지 상태에서 화면이 꺼져 있을 때 CPU 및 네트워크 액티비티를 지연시켜서 배터리 수명 개선
** Android 7.0
기기의 플러그를 뽑고 화면이 꺼져 있는 동안 CPU 및 네트워크 제한의 하위 세트를 적용하여 잠자기 모드 향상. 하지만 항상 정지 상태일 필요 X(ex: 주머니에 있는경우)

### Project Svelte:백그라운드 최적화
메모리 사용량 및 전원 소비량을 최적화하기 위해 세 가지 암시적 브로드캐스트를 제거. 암시적 브로드캐스트는 백그라운드에서 브로드캐스트를 수신하도록 
앱을 자주 시작하기 때문. 이들을 제거하면 기기 성능과 사용자 환경이 상당히 향상될 수 있다. 

권한 변경
-------------

### 파일 시스템 권한 변경
개인 파일의 보안을 강화하기 위해, 7.0이상의 대상으로 하는 앱의 개인 디렉터리는 액세스 제한. 이것은 개인파일의 메타데이터 유출을 막을 수 있다.
하지만 부작용도 포함.

앱 사이의 파일 공유
-------------
* 7.0버전에서는 Android 프레임워크는 앱 외부터에서 ```file```URI의 노출을 금지하는 **StrictMode** API정책 사용.
파일 URI를 포함하는 인텐트가 앱을 떠나면 **FilerUriExposedException** 예외와 함께 오류 발생
* 애플리케이션 간에 파일을 공유하기위해서는 ```content://``` URI를 보내고 이에 대한 임시 액세스 권한이 필요.
* FileProvider클래스를 사용하면 이 권한을 가장 쉽게 부여 가능.

접근성 향상
-------------
시력이나쁘거나 손상된 사용자를 위한 업데이트. 앱의 코드를 변경할 필요 X

### 화면 확대/축소
사용자가 Display Size를 직접 설정 가능. 

### 설정 마법사의 Vision Settings
Android 7.0에는 Welcome 화면에 Vision Settings가 포함되어 있으며, 
여기서 사용자는 확대 제스처, 글꼴 크기, 디스플레이 크기 및 음성 안내 지원의 접근성 설정을 새 기기에 구성할 수 있다.
이러한 변경은 다른 화면 설정에 관련된 버그의 가시성을 증대시킵니다. 
이 기능의 영향을 평가하려면, 이들 설정을 활성화하여 앱을 테스트해야 합니다. 
이 설정은 Settings > Accessibility 아래에 있습니다.

플랫폼 라이브러리에 연결되는 NDK 앱
-------------
모든 개발자는 Android 7.0을 실행하는 기기에서 앱 작동이 중단되지 않도록 확인해야 합니다. 
네이티브 코드를 사용하는 앱을 위해 공개 NDK API만 사용해야 합니다.
<img src="https://user-images.githubusercontent.com/48199401/60326901-92ae1500-99c5-11e9-9f4c-eb5bd295792a.PNG">

### 앱이 비공개 라이브러리를 사용하는지 확인
비공개 라이브러리를 로드하는 문제를 식별하는데 도움을 주기 위해 logcat이 경고 또는 런타임 오류를 생성할 수 있습니다.

### 앱 업데이트
다양한 오류를 수정하고 향후 업데이트에서 앱 작동이 중단되는지 확인할때 취할수 있는 조치
* 앱이 비공개 플랫폼 라이브러리를 사용하는 경우, 라이브러리 사본을 포함해서 업데이트 하거나 공개 NDK API를 사용해야 함
* 앱이 비공개 심볼에 액세스하는 타사 라이브러리를 사용하는 경우, 라이브러리 작성자에게 연락하여 라이브러리를 업데이트.
* 모든 비 NDK 라이브러리를 APK와 패키징해야 하는지 확인.

Android for Work
-------------
Android for Work를 대상으로 하는 앱에 대한 변경 사항이 포함되어 있다. 
인증서 설치, 비밀번호 재설정, 보조 사용자 관리 및 기기 식별자 액세스에 대한 변경 사항이 포함되어 있다. 

주석 보존
-------------
주석의 표시 여부가 무시되던 버그 수정.
* VISIBILITY_BUILD: 빌드 시에만 표시되어야 합니다
* VISIBILITY_SYSTEM: 런타임에 기본 시스템에만 표시되어야 합니다.

기타
-------------
* 앱이 Android 7.0에서 실행 중일 때 API 레벨이 낮고 사용자가 표시 크기를 변경하는 경우, 해당 앱 프로세스가 종료.
* Android 7.0에서 앱은 구성 변경을 매끄럽게 처리할 수 있어야 하며, 이후에 시작할 때도 작동이 중단되어서는 안 됩니다. 
글꼴 크기(Setting >Display > Font size)를 변경하여 앱 동작을 검사한 다음, Recents에서 앱을 복원할 수 있습니다.
* 이전 버전의 Android에서는 버그 때문에, 시스템이 주 스레드에서 TCP 소켓에 대한 쓰기를 엄격 모드 위반으로서 플래그하지 못했습니다.
7.0에서는 버그수정.
* 상당수 플랫폼 API는 이제 대용량 페이로드가 Binder 트랜잭션을 통해 전송되는 것을 확인하기 시작했으며, 
시스템에서는 이제 TransactionTooLargeExceptions를 자동으로 로깅하거나 억제하는 대신 RuntimeExceptions로 다시 발생시킵니다. 
한 가지 공통적인 예는 Activity.onSaveInstanceState()에 너무 많은 데이터를 저장하는 바람에, 
앱이 Android 7.0을 대상으로 할 때 ActivityThread.StopInfo가 RuntimeException을 발생시키는 경우입니다.
* 앱이 Runnable 작업을 View에 게시하고 View가 창에 연결되지 않은 경우, 
시스템은 View가 있는 Runnable 작업을 큐에 넣으며, 
Runnable 작업은 View가 창에 연결될 때까지 실행되지 않습니다. 
이 동작은 다음과 같은 버그를 수정합니다.

> 이중에 기타에서 변경점중에서도 살펴볼만한 건덕지들이 많은것 같고, 백그라운드 최적화 부분도 살펴보면 매우 좋을것 같다.

출처 및 자세한 내용은 [이곳](https://developer.android.com/about/versions/nougat/android-7.0-changes?hl=ko)에서 추가로 볼 수 있다.
